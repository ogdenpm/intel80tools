	ORG	00H
POWER:	JMP	START
	ORG	03H
EXTRN0:	JMP	START
	ORG	0BH
IMER0:	JMP	TIMINT0
	ORG	13H
XTRN1:	JMP	START
	ORG	1BH
IMER1:	JMP	START
	ORG	23H
SIOINT:	JMP 	START
;
;
TIMINT0:	PUSH	PSW
	PUSH	ACC
	PUSH	DPL
	PUSH	DPH
	CLR	TF0
	POP	DPH
	POP	DPL
	POP	ACC
	POP	PSW
	RETI
;
;
START:	MOV	SP,#07H		;INIT STACK
	MOV	IE,#00000000B	;NO INTERRUPTS
	JMP	INIT
MAIN1:	MOV	A,#0EH
	CALL	OUTLED
	CALL	LEDON
	CALL	CHKSW1
	MOV	A,#0CH
	CALL	OUTLED
MAIN10:	JMP	MAIN10
;
;
INIT:	MOV	R0,#01H
INIT1:	MOV	@R0,#00H
	INC	R0
	MOV	A,R0
	JNB	ACC.7,INIT1
;
	MOV	DPTR,#0E003H
	MOV	A,#89H
	MOVX	@DPTR,A		;INIT 8255
;
	MOV	DPTR,#0E001H
	MOV	A,#00H
	MOVX	@DPTR,A
;
	MOV	DPTR,#0E000H
	MOV	A,#02
	MOVX	@DPTR,A
;
	MOV	P1,#0FFH	;INIT PORT 1
	MOV	TMOD,#00100001B
	MOV	TL1,#0FDH
	SETB	TR1
	MOV	SCON,#01000000B
	JMP	MAIN1
;
;
;
OUTLED:	MOV	R1,A
	MOV	DPTR,#0E000H
	MOVX	A,@DPTR
	ANL	A,#0FH
	XCH	A,R1
	ANL	A,#0FH
	SWAP	A
	ORL	A,R1
	MOVX	@DPTR,A
	RET
;
LEDON:	MOV	DPTR,#0E000H
	MOVX	A,@DPTR
	CLR	ACC.3
	MOVX	@DPTR,A
	RET
;
;
CHKSW1:	MOV	DPTR,#0E002H
	MOVX	A,@DPTR
	JB	ACC.7,CHKSW1
	RET
;
	END
